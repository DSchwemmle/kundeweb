{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Dominik/software-engineering/kundeweb/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _CreateKundeComponent_instances, _CreateKundeComponent_setProps, _CreateKundeComponent_handleError, _CreateKundeComponent_navigateHome;\nimport { __classPrivateFieldGet } from \"tslib\";\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { toKunde } from './kundeForm';\nimport { SaveError } from '../shared'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport log from 'loglevel';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/platform-browser\";\nfunction CreateKundeComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"mat-card\")(2, \"mat-card-title\");\n    i0.ɵɵtext(3, \" Achtung! \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"br\");\n    i0.ɵɵtext(5, \" Wenn Sie die Seite jetzt verlassen, verlieren Sie Ihre eingegebenen Daten. \");\n    i0.ɵɵelementEnd()();\n  }\n}\n/**\r\n * Komponente mit dem Tag \"hs-create-kunde\" um das Erfassungsformular\r\n * für einen neuen Kunde zu realisieren.\r\n */\nexport class CreateKundeComponent {\n  constructor(service, router, titleService) {\n    this.service = service;\n    this.router = router;\n    this.titleService = titleService;\n    _CreateKundeComponent_instances.add(this);\n    this.createForm = new FormGroup({});\n    this.showWarning = false;\n    this.fertig = false;\n    this.errorMsg = undefined;\n    log.debug('CreateKundeComponent.constructor: Injizierter Router:', router);\n  }\n  ngOnInit() {\n    this.titleService.setTitle('Neuer Kunde');\n  }\n  /**\r\n   * Die Methode <code>onSubmit</code> realisiert den Event-Handler, wenn das\r\n   * Formular abgeschickt wird, um einen neuen Kunde anzulegen.\r\n   * @return false, um das durch den Button-Klick ausgel&ouml;ste Ereignis\r\n   *         zu konsumieren.\r\n   */\n  onSubmit() {\n    // In einem Control oder in einer FormGroup gibt es u.a. folgende\n    // Properties\n    //    value     JSON-Objekt mit den IDs aus der FormGroup als\n    //              Schluessel und den zugehoerigen Werten\n    //    errors    Map<string,any> mit den Fehlern, z.B. {'required': true}\n    //    valid/invalid     fuer valide Werte\n    //    dirty/pristine    falls der Wert geaendert wurde\n    if (this.createForm.invalid) {\n      log.debug('CreateKundeComponent.onSave: Validierungsfehler', this.createForm);\n    }\n    const kundeForm = this.createForm.value;\n    const neuerKunde = toKunde(kundeForm);\n    log.debug('CreateKundeComponent.onSave: neuerKunde=', neuerKunde);\n    this.service.save(neuerKunde).pipe(\n    // 1. Datensatz empfangen und danach implizites \"unsubscribe\"\n    first(), tap(result => __classPrivateFieldGet(this, _CreateKundeComponent_instances, \"m\", _CreateKundeComponent_setProps).call(this, result)))\n    // asynchrone Funktionen nur bei subscribe, nicht bei tap\n    .subscribe({\n      next: () => __classPrivateFieldGet(this, _CreateKundeComponent_instances, \"m\", _CreateKundeComponent_navigateHome).call(this)\n    });\n  }\n}\n_CreateKundeComponent_instances = new WeakSet(), _CreateKundeComponent_setProps = function _CreateKundeComponent_setProps(result) {\n  if (result instanceof SaveError) {\n    __classPrivateFieldGet(this, _CreateKundeComponent_instances, \"m\", _CreateKundeComponent_handleError).call(this, result);\n    return;\n  }\n  this.fertig = true;\n  this.showWarning = false;\n  this.errorMsg = undefined;\n  const id = result;\n  log.debug('CreateKundeComponent.#setProps: id=', id);\n}, _CreateKundeComponent_handleError = function _CreateKundeComponent_handleError(err) {\n  const {\n    statuscode\n  } = err;\n  log.debug(`CreateKundeComponent.#handleError: statuscode=${statuscode}, err=`, err);\n  switch (statuscode) {\n    case 422 /* HttpStatusCode.UnprocessableEntity */:\n      {\n        const {\n          cause\n        } = err;\n        // TODO Aufbereitung der Fehlermeldung: u.a. Anfuehrungszeichen\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n        this.errorMsg = cause instanceof HttpErrorResponse ? cause.error : JSON.stringify(cause);\n        break;\n      }\n    case 429 /* HttpStatusCode.TooManyRequests */:\n      this.errorMsg = 'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n      break;\n    case 504 /* HttpStatusCode.GatewayTimeout */:\n      this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n      log.error('Laeuft der Appserver? Port-Forwarding?');\n      break;\n    default:\n      this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n      break;\n  }\n}, _CreateKundeComponent_navigateHome = /*#__PURE__*/function () {\n  var _CreateKundeComponent_navigateHome2 = _asyncToGenerator(function* () {\n    if (this.errorMsg === undefined) {\n      log.debug('CreateKundeComponent.#navigateHome: Navigation');\n      yield this.router.navigate(['/']);\n    }\n  });\n  function _CreateKundeComponent_navigateHome() {\n    return _CreateKundeComponent_navigateHome2.apply(this, arguments);\n  }\n  return _CreateKundeComponent_navigateHome;\n}();\nCreateKundeComponent.ɵfac = function CreateKundeComponent_Factory(t) {\n  return new (t || CreateKundeComponent)(i0.ɵɵdirectiveInject(i1.KundeWriteService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.Title));\n};\nCreateKundeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CreateKundeComponent,\n  selectors: [[\"hs-create-kunde\"]],\n  decls: 39,\n  vars: 17,\n  consts: [[\"role\", \"form\", 3, \"formGroup\"], [\"class\", \"warning-box\", 4, \"ngIf\"], [1, \"box-create\"], [\"cols\", \"1\", \"rowHeight\", \"100px\"], [\"role\", \"form\", 3, \"submit\"], [1, \"element-create\", 3, \"createForm\"], [1, \"split-section\"], [\"id\", \"buttonCreate\", \"mat-raised-button\", \"\", \"color\", \"primary\", \"matTooltip\", \"Hier dr\\u00FCcken um Kunden anzulegen\", \"type\", \"submit\", 3, \"disabled\", \"click\"], [3, \"text\"], [1, \"warning-box\"]],\n  template: function CreateKundeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"form\", 0);\n      i0.ɵɵtemplate(1, CreateKundeComponent_div_1_Template, 6, 0, \"div\", 1);\n      i0.ɵɵelementStart(2, \"div\", 2)(3, \"mat-grid-list\", 3)(4, \"form\", 4);\n      i0.ɵɵlistener(\"submit\", function CreateKundeComponent_Template_form_submit_4_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵelementStart(5, \"mat-grid-tile\")(6, \"h2\");\n      i0.ɵɵtext(7, \"Anlegen eines Kunden\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(8, \"mat-grid-tile\");\n      i0.ɵɵelement(9, \"hs-create-nachname\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"mat-grid-tile\");\n      i0.ɵɵelement(11, \"hs-create-email\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"mat-grid-tile\");\n      i0.ɵɵelement(13, \"hs-create-homepage\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"mat-grid-tile\")(15, \"div\", 6);\n      i0.ɵɵelement(16, \"hs-create-geburtsdatum\", 5)(17, \"hs-create-geschlecht\", 5);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(18, \"mat-grid-tile\")(19, \"div\", 6);\n      i0.ɵɵelement(20, \"hs-create-kategorie\", 5)(21, \"hs-create-familienstand\", 5);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(22, \"mat-grid-tile\")(23, \"div\", 6);\n      i0.ɵɵelement(24, \"hs-create-plz\", 5)(25, \"hs-create-ort\", 5);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(26, \"mat-grid-tile\")(27, \"div\", 6);\n      i0.ɵɵelement(28, \"hs-create-betrag\", 5)(29, \"hs-create-waehrung\", 5);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(30, \"mat-grid-tile\");\n      i0.ɵɵelement(31, \"hs-create-interessen\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"mat-grid-tile\");\n      i0.ɵɵelement(33, \"hs-create-newsletter\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"mat-grid-tile\")(35, \"button\", 7);\n      i0.ɵɵlistener(\"click\", function CreateKundeComponent_Template_button_click_35_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵtext(36, \" Kunde anlegen \");\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelementStart(37, \"div\");\n      i0.ɵɵelement(38, \"hs-error-message\", 8);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"formGroup\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.showWarning);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"createForm\", ctx.createForm);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"disabled\", ctx.createForm.invalid);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"text\", ctx.errorMsg);\n    }\n  },\n  styles: [\"[_ngcontent-%COMP%]:root {\\n  --bluesky: rgb(190 214 248);\\n  --red: rgb(217 28 13);\\n  --black: black;\\n}\\n\\n[_ngcontent-%COMP%]:root {\\n  --background-color: var(--bluesky);\\n  --gradient: url(\\\"/assets/img/gradientBlueSky.webp\\\");\\n}\\n\\n.box-create[_ngcontent-%COMP%] {\\n  width: 100%;\\n}\\n\\n.element-create[_ngcontent-%COMP%] {\\n  width: 50%;\\n}\\n\\n.userInputField[_ngcontent-%COMP%] {\\n  width: 100%;\\n}\\n\\n.interessen-section[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-content: center;\\n  align-items: center;\\n  gap: 60px;\\n}\\n\\n.split-section[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-content: left;\\n  align-items: center;\\n  width: 50%;\\n  gap: 10px;\\n}\\n\\n.warning-box[_ngcontent-%COMP%] {\\n  width: 80%;\\n  margin: auto;\\n  padding-top: 25px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvc2Fzcy9fY29sb3JzLnNjc3MiLCJ3ZWJwYWNrOi8vLi9zcmMvYXBwL2t1bmRlL2NyZWF0ZS1rdW5kZS9jcmVhdGUta3VuZGUuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBaUJBO0VBRUUsMkJBQUE7RUFDQSxxQkFBQTtFQUdBLGNBQUE7QUNuQkY7O0FBYUE7RUFDRSxrQ0FBQTtFQUNBLG1EQUFBO0FBVkY7O0FBYUE7RUFDRSxXQUFBO0FBVkY7O0FBY0E7RUFDRSxVQUFBO0FBWEY7O0FBZUE7RUFDRSxXQUFBO0FBWkY7O0FBZUE7RUFDRSxhQUFBO0VBQ0EscUJBQUE7RUFDQSxtQkFBQTtFQUNBLFNBQUE7QUFaRjs7QUFlQTtFQUNFLGFBQUE7RUFDQSxtQkFBQTtFQUNBLG1CQUFBO0VBQ0EsVUFBQTtFQUNBLFNBQUE7QUFaRjs7QUFlQTtFQUNFLFVBQUE7RUFDQSxZQUFBO0VBQ0EsaUJBQUE7QUFaRiIsInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoQykgMjAxNyAtIHByZXNlbnQgSnVlcmdlbiBaaW1tZXJtYW5uLCBIb2Noc2NodWxlIEthcmxzcnVoZVxuLy9cbi8vIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4vLyBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxuLy8gdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3Jcbi8vIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4vL1xuLy8gVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4vLyBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuLy8gTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZVxuLy8gR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbi8vXG4vLyBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZVxuLy8gYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0uICBJZiBub3QsIHNlZSA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uXG5cbi8vIFwiUGFydGlhbFwiIERhdGVpIGFscyBIaWxmc2RhdGVpIGZ1ZXIgQHVzZSwgZC5oLiBXaWVkZXJ2ZXJ3ZW5kdW5nXG5cbjpyb290IHtcbiAgLy8gLS1ibHVlc2t5OiAjYmVkNmY4O1xuICAtLWJsdWVza3k6IHJnYigxOTAgMjE0IDI0OCk7XG4gIC0tcmVkOiByZ2IoMjE3IDI4IDEzKTtcblxuICAvLyAkYmxhY2s6IHJnYigwIDAgMCk7XG4gIC0tYmxhY2s6IGJsYWNrO1xufVxuIiwiLy8gQ29weXJpZ2h0IChDKSAyMDE1IC0gcHJlc2VudCBKdWVyZ2VuIFppbW1lcm1hbm4sIEhvY2hzY2h1bGUgS2FybHNydWhlXG4vL1xuLy8gVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbi8vIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4vLyB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvclxuLy8gKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbi8vXG4vLyBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbi8vIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4vLyBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlXG4vLyBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuLy9cbi8vIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlXG4vLyBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cblxuQHVzZSAnLi4vLi4vc2Fzcy9jb2xvcnMnO1xuXG46cm9vdCB7XG4gIC0tYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmx1ZXNreSk7XG4gIC0tZ3JhZGllbnQ6IHVybCgnL2Fzc2V0cy9pbWcvZ3JhZGllbnRCbHVlU2t5LndlYnAnKTtcbn1cblxuLmJveC1jcmVhdGUge1xuICB3aWR0aDogMTAwJTtcbiAgLy9iYWNrZ3JvdW5kOiByZWQ7XG59XG5cbi5lbGVtZW50LWNyZWF0ZSB7XG4gIHdpZHRoOiA1MCU7XG4gIC8vYmFja2dyb3VuZDogYmx1ZTtcbn1cblxuLnVzZXJJbnB1dEZpZWxkIHtcbiAgd2lkdGg6IDEwMCU7XG59XG5cbi5pbnRlcmVzc2VuLXNlY3Rpb24ge1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1jb250ZW50OiBjZW50ZXI7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGdhcDogNjBweDtcbn1cblxuLnNwbGl0LXNlY3Rpb24ge1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1jb250ZW50OiBsZWZ0O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuICB3aWR0aDogNTAlO1xuICBnYXA6IDEwcHg7XG59XG5cbi53YXJuaW5nLWJveCB7XG4gIHdpZHRoOiA4MCU7XG4gIG1hcmdpbjogYXV0bztcbiAgcGFkZGluZy10b3A6IDI1cHg7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":";;;AAoBA,SAASA,iBAAiB,QAAwB,sBAAsB;AACxE,SAAyBC,OAAO,QAAQ,aAAa;AACrD,SAA4BC,SAAS,QAAQ,WAAW,CAAC,CAAC;AAC1D,SAASC,KAAK,EAAEC,GAAG,QAAQ,gBAAgB;AAC3C,SAASC,SAAS,QAAQ,gBAAgB;AAG1C,OAAOC,GAAG,MAAM,UAAU;;;;;;;ICRxBC,8BAA6C;IAExBA,0BAAS;IAAAA,iBAAiB;IAC3CA,qBAAM;IACNA,4FACF;IAAAA,iBAAW;;;ADKf;;;;AASA,OAAM,MAAOC,oBAAoB;EAS7BC,YACqBC,OAA0B,EAC1BC,MAAc,EACdC,YAAmB;IAFnB,YAAO,GAAPF,OAAO;IACP,WAAM,GAANC,MAAM;IACN,iBAAY,GAAZC,YAAY;;IAXxB,eAAU,GAAG,IAAIP,SAAS,CAAC,EAAE,CAAC;IAEvC,gBAAW,GAAG,KAAK;IAEnB,WAAM,GAAG,KAAK;IAEd,aAAQ,GAAuBQ,SAAS;IAOpCP,GAAG,CAACQ,KAAK,CACL,uDAAuD,EACvDH,MAAM,CACT;EACL;EAEAI,QAAQ;IACJ,IAAI,CAACH,YAAY,CAACI,QAAQ,CAAC,aAAa,CAAC;EAC7C;EAEA;;;;;;EAMAC,QAAQ;IACJ;IACA;IACA;IACA;IACA;IACA;IACA;IAEA,IAAI,IAAI,CAACC,UAAU,CAACC,OAAO,EAAE;MACzBb,GAAG,CAACQ,KAAK,CACL,iDAAiD,EACjD,IAAI,CAACI,UAAU,CAClB;;IAGL,MAAME,SAAS,GAAG,IAAI,CAACF,UAAU,CAACG,KAAkB;IACpD,MAAMC,UAAU,GAAGrB,OAAO,CAACmB,SAAS,CAAC;IACrCd,GAAG,CAACQ,KAAK,CAAC,0CAA0C,EAAEQ,UAAU,CAAC;IAEjE,IAAI,CAACZ,OAAO,CACPa,IAAI,CAACD,UAAU,CAAC,CAChBE,IAAI;IACD;IACArB,KAAK,EAAE,EACPC,GAAG,CAACqB,MAAM,IAAIC,2BAAI,uEAAU,MAAd,IAAI,EAAWD,MAAM,CAAC,CAAC;IAEzC;IAAA,CACCE,SAAS,CAAC;MAAEC,IAAI,EAAE,MAAMF,2BAAI,2EAAc,MAAlB,IAAI;IAAgB,CAAE,CAAC;EACxD;;0HAEUD,MAA0B;EAChC,IAAIA,MAAM,YAAYvB,SAAS,EAAE;IAC7BwB,2BAAI,0EAAa,MAAjB,IAAI,EAAcD,MAAM,CAAC;IACzB;;EAGJ,IAAI,CAACI,MAAM,GAAG,IAAI;EAClB,IAAI,CAACC,WAAW,GAAG,KAAK;EACxB,IAAI,CAACC,QAAQ,GAAGlB,SAAS;EAEzB,MAAMmB,EAAE,GAAGP,MAAM;EACjBnB,GAAG,CAACQ,KAAK,CAAC,qCAAqC,EAAEkB,EAAE,CAAC;AACxD,CAAC,iFAEYC,GAAc;EACvB,MAAM;IAAEC;EAAU,CAAE,GAAGD,GAAG;EAC1B3B,GAAG,CAACQ,KAAK,CACL,iDAAiDoB,UAAU,QAAQ,EACnED,GAAG,CACN;EAED,QAAQC,UAAU;IACd;MAAyC;QACrC,MAAM;UAAEC;QAAK,CAAE,GAAGF,GAAG;QACrB;QACA;QACA,IAAI,CAACF,QAAQ,GACTI,KAAK,YAAYnC,iBAAiB,GAC5BmC,KAAK,CAACC,KAAK,GACXC,IAAI,CAACC,SAAS,CAACH,KAAK,CAAC;QAC/B;;IAGJ;MACI,IAAI,CAACJ,QAAQ,GACT,+DAA+D;MACnE;IAEJ;MACI,IAAI,CAACA,QAAQ,GAAG,sCAAsC;MACtDzB,GAAG,CAAC8B,KAAK,CAAC,wCAAwC,CAAC;MACnD;IAEJ;MACI,IAAI,CAACL,QAAQ,GAAG,yCAAyC;MACzD;EAAM;AAElB,CAAC;EAAA,4DAED,aAAK;IACD,IAAI,IAAI,CAACA,QAAQ,KAAKlB,SAAS,EAAE;MAC7BP,GAAG,CAACQ,KAAK,CAAC,gDAAgD,CAAC;MAC3D,MAAM,IAAI,CAACH,MAAM,CAAC4B,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;;EAEzC,CAAC;EAAA,SALIC;IAAA;EAAA;EAAA;AAAA,GAKJ;;mBAnHQhC,oBAAoB;AAAA;;QAApBA,oBAAoB;EAAAiC;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCrBjCtC,+BAA2C;MAEzCA,qEAMM;MAENA,8BAAwB;MAEdA;QAAA,OAAUuC,cAAU;MAAA,EAAC;MACzBvC,qCAAe;MAAIA,oCAAoB;MAAAA,iBAAK;MAE5CA,qCAAe;MACbA,wCAGsB;MACxBA,iBAAgB;MAChBA,sCAAe;MACbA,sCAGmB;MACrBA,iBAAgB;MAChBA,sCAAe;MACbA,yCAGsB;MACxBA,iBAAgB;MAChBA,sCAAe;MAEXA,6CAG0B;MAK5BA,iBAAM;MAERA,sCAAe;MAEXA,0CAGuB;MAKzBA,iBAAM;MAERA,sCAAe;MAEXA,oCAGiB;MAKnBA,iBAAM;MAERA,sCAAe;MAEXA,uCAGoB;MAKtBA,iBAAM;MAERA,sCAAe;MACbA,2CAGwB;MAC1BA,iBAAgB;MAChBA,sCAAe;MACbA,2CAGwB;MAC1BA,iBAAgB;MAEhBA,sCAAe;MAOXA;QAAA,OAASuC,cAAU;MAAA,EAAC;MAGpBvC,gCACF;MAAAA,iBAAS;MAQnBA,4BAAK;MACHA,uCAAuD;MACzDA,iBAAM;;;MAnHAA,0CAAwB;MAEFA,eAAiB;MAAjBA,sCAAiB;MAgBjCA,eAAyB;MAAzBA,2CAAyB;MAMzBA,eAAyB;MAAzBA,2CAAyB;MAMzBA,eAAyB;MAAzBA,2CAAyB;MAOvBA,eAAyB;MAAzBA,2CAAyB;MAIzBA,eAAyB;MAAzBA,2CAAyB;MAQzBA,eAAyB;MAAzBA,2CAAyB;MAIzBA,eAAyB;MAAzBA,2CAAyB;MAQzBA,eAAyB;MAAzBA,2CAAyB;MAIzBA,eAAyB;MAAzBA,2CAAyB;MAQzBA,eAAyB;MAAzBA,2CAAyB;MAIzBA,eAAyB;MAAzBA,2CAAyB;MAO3BA,eAAyB;MAAzBA,2CAAyB;MAMzBA,eAAyB;MAAzBA,2CAAyB;MAYzBA,eAA+B;MAA/BA,iDAA+B;MAYvBA,eAAiB;MAAjBA,mCAAiB","names":["HttpErrorResponse","toKunde","SaveError","first","tap","FormGroup","log","i0","CreateKundeComponent","constructor","service","router","titleService","undefined","debug","ngOnInit","setTitle","onSubmit","createForm","invalid","kundeForm","value","neuerKunde","save","pipe","result","__classPrivateFieldGet","subscribe","next","fertig","showWarning","errorMsg","id","err","statuscode","cause","error","JSON","stringify","navigate","_CreateKundeComponent_navigateHome","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\Dominik\\software-engineering\\kundeweb\\src\\app\\kunde\\create-kunde\\create-kunde.component.ts","C:\\Users\\Dominik\\software-engineering\\kundeweb\\src\\app\\kunde\\create-kunde\\create-kunde.component.html"],"sourcesContent":["/* eslint-disable eslint-comments/disable-enable-pair */\n/* eslint-disable import/no-unresolved */\n/*\n * Copyright (C) 2015 - present Juergen Zimmermann, Hochschule Karlsruhe\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { Component, type OnInit } from '@angular/core';\nimport { HttpErrorResponse, HttpStatusCode } from '@angular/common/http';\nimport { type KundeForm, toKunde } from './kundeForm';\nimport { KundeWriteService, SaveError } from '../shared'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport { Router } from '@angular/router'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport { Title } from '@angular/platform-browser'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport log from 'loglevel';\n\n/**\n * Komponente mit dem Tag \"hs-create-kunde\" um das Erfassungsformular\n * für einen neuen Kunde zu realisieren.\n */\n@Component({\n    selector: 'hs-create-kunde',\n    templateUrl: './create-kunde.component.html',\n    styleUrls: ['./create-kunde.component.scss'],\n})\nexport class CreateKundeComponent implements OnInit {\n    readonly createForm = new FormGroup({});\n\n    showWarning = false;\n\n    fertig = false;\n\n    errorMsg: string | undefined = undefined;\n\n    constructor(\n        private readonly service: KundeWriteService,\n        private readonly router: Router,\n        private readonly titleService: Title,\n    ) {\n        log.debug(\n            'CreateKundeComponent.constructor: Injizierter Router:',\n            router,\n        );\n    }\n\n    ngOnInit() {\n        this.titleService.setTitle('Neuer Kunde');\n    }\n\n    /**\n     * Die Methode <code>onSubmit</code> realisiert den Event-Handler, wenn das\n     * Formular abgeschickt wird, um einen neuen Kunde anzulegen.\n     * @return false, um das durch den Button-Klick ausgel&ouml;ste Ereignis\n     *         zu konsumieren.\n     */\n    onSubmit() {\n        // In einem Control oder in einer FormGroup gibt es u.a. folgende\n        // Properties\n        //    value     JSON-Objekt mit den IDs aus der FormGroup als\n        //              Schluessel und den zugehoerigen Werten\n        //    errors    Map<string,any> mit den Fehlern, z.B. {'required': true}\n        //    valid/invalid     fuer valide Werte\n        //    dirty/pristine    falls der Wert geaendert wurde\n\n        if (this.createForm.invalid) {\n            log.debug(\n                'CreateKundeComponent.onSave: Validierungsfehler',\n                this.createForm,\n            );\n        }\n\n        const kundeForm = this.createForm.value as KundeForm;\n        const neuerKunde = toKunde(kundeForm);\n        log.debug('CreateKundeComponent.onSave: neuerKunde=', neuerKunde);\n\n        this.service\n            .save(neuerKunde)\n            .pipe(\n                // 1. Datensatz empfangen und danach implizites \"unsubscribe\"\n                first(),\n                tap(result => this.#setProps(result)),\n            )\n            // asynchrone Funktionen nur bei subscribe, nicht bei tap\n            .subscribe({ next: () => this.#navigateHome() });\n    }\n\n    #setProps(result: SaveError | string) {\n        if (result instanceof SaveError) {\n            this.#handleError(result);\n            return;\n        }\n\n        this.fertig = true;\n        this.showWarning = false;\n        this.errorMsg = undefined;\n\n        const id = result;\n        log.debug('CreateKundeComponent.#setProps: id=', id);\n    }\n\n    #handleError(err: SaveError) {\n        const { statuscode } = err;\n        log.debug(\n            `CreateKundeComponent.#handleError: statuscode=${statuscode}, err=`,\n            err,\n        );\n\n        switch (statuscode) {\n            case HttpStatusCode.UnprocessableEntity: {\n                const { cause } = err;\n                // TODO Aufbereitung der Fehlermeldung: u.a. Anfuehrungszeichen\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                this.errorMsg =\n                    cause instanceof HttpErrorResponse\n                        ? cause.error\n                        : JSON.stringify(cause);\n                break;\n            }\n\n            case HttpStatusCode.TooManyRequests:\n                this.errorMsg =\n                    'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n                break;\n\n            case HttpStatusCode.GatewayTimeout:\n                this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n                log.error('Laeuft der Appserver? Port-Forwarding?');\n                break;\n\n            default:\n                this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n                break;\n        }\n    }\n\n    async #navigateHome() {\n        if (this.errorMsg === undefined) {\n            log.debug('CreateKundeComponent.#navigateHome: Navigation');\n            await this.router.navigate(['/']);\n        }\n    }\n}\n","<!--\n    Copyright (C) 2015 - present Juergen Zimmermann, Hochschule Karlsruhe\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n-->\n<!-- dynamisches Formular durch formGroup -->\n<form [formGroup]=\"createForm\" role=\"form\">\n  <!-- Todo Implement FontAwesome icon for warning symbol -->\n  <div class=\"warning-box\" *ngIf=\"showWarning\">\n    <mat-card>\n      <mat-card-title> Achtung! </mat-card-title>\n      <br />\n      Wenn Sie die Seite jetzt verlassen, verlieren Sie Ihre eingegebenen Daten.\n    </mat-card>\n  </div>\n\n  <div class=\"box-create\">\n    <mat-grid-list cols=\"1\" rowHeight=\"100px\">\n      <form (submit)=\"onSubmit()\" role=\"form\">\n        <mat-grid-tile><h2>Anlegen eines Kunden</h2></mat-grid-tile>\n        <!-- Forms go in here -->\n        <mat-grid-tile>\n          <hs-create-nachname\n            class=\"element-create\"\n            [createForm]=\"createForm\"\n          ></hs-create-nachname>\n        </mat-grid-tile>\n        <mat-grid-tile>\n          <hs-create-email\n            class=\"element-create\"\n            [createForm]=\"createForm\"\n          ></hs-create-email>\n        </mat-grid-tile>\n        <mat-grid-tile>\n          <hs-create-homepage\n            class=\"element-create\"\n            [createForm]=\"createForm\"\n          ></hs-create-homepage>\n        </mat-grid-tile>\n        <mat-grid-tile>\n          <div class=\"split-section\">\n            <hs-create-geburtsdatum\n              class=\"element-create\"\n              [createForm]=\"createForm\"\n            ></hs-create-geburtsdatum>\n            <hs-create-geschlecht\n              class=\"element-create\"\n              [createForm]=\"createForm\"\n            ></hs-create-geschlecht>\n          </div>\n        </mat-grid-tile>\n        <mat-grid-tile>\n          <div class=\"split-section\">\n            <hs-create-kategorie\n              class=\"element-create\"\n              [createForm]=\"createForm\"\n            ></hs-create-kategorie>\n            <hs-create-familienstand\n              class=\"element-create\"\n              [createForm]=\"createForm\"\n            ></hs-create-familienstand>\n          </div>\n        </mat-grid-tile>\n        <mat-grid-tile>\n          <div class=\"split-section\">\n            <hs-create-plz\n              class=\"element-create\"\n              [createForm]=\"createForm\"\n            ></hs-create-plz>\n            <hs-create-ort\n              class=\"element-create\"\n              [createForm]=\"createForm\"\n            ></hs-create-ort>\n          </div>\n        </mat-grid-tile>\n        <mat-grid-tile>\n          <div class=\"split-section\">\n            <hs-create-betrag\n              class=\"element-create\"\n              [createForm]=\"createForm\"\n            ></hs-create-betrag>\n            <hs-create-waehrung\n              class=\"element-create\"\n              [createForm]=\"createForm\"\n            ></hs-create-waehrung>\n          </div>\n        </mat-grid-tile>\n        <mat-grid-tile>\n          <hs-create-interessen\n            class=\"element-create\"\n            [createForm]=\"createForm\"\n          ></hs-create-interessen>\n        </mat-grid-tile>\n        <mat-grid-tile>\n          <hs-create-newsletter\n            class=\"element-create\"\n            [createForm]=\"createForm\"\n          ></hs-create-newsletter>\n        </mat-grid-tile>\n        <!-- Forms end here -->\n        <mat-grid-tile>\n          <button\n            id=\"buttonCreate\"\n            mat-raised-button\n            color=\"primary\"\n            matTooltip=\"Hier drücken um Kunden anzulegen\"\n            type=\"submit\"\n            (click)=\"onSubmit()\"\n            [disabled]=\"createForm.invalid\"\n          >\n            Kunde anlegen\n          </button>\n        </mat-grid-tile>\n      </form>\n    </mat-grid-list>\n  </div>\n</form>\n\n<!-- Todo update Legacy error message to angular -->\n<div>\n  <hs-error-message [text]=\"errorMsg\"></hs-error-message>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}