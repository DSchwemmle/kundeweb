{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Dominik/software-engineering/kundeweb/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _UpdateKundeComponent_instances, _UpdateKundeComponent_setProps, _UpdateKundeComponent_handleFindError, _UpdateKundeComponent_handleUpdateResult, _UpdateKundeComponent_navigateHome;\nimport { __classPrivateFieldGet } from \"tslib\";\n/* eslint-disable @typescript-eslint/consistent-type-imports */\nimport { FindError, UpdateError } from '../shared';\n// eslint-disable-next-line import/no-unresolved\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport log from 'loglevel';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared\";\nimport * as i2 from \"@angular/platform-browser\";\nimport * as i3 from \"@angular/router\";\n/**\r\n * Komponente f&uuml;r das Tag <code>hs-update-buch</code>\r\n */\nexport class UpdateKundeComponent {\n  // eslint-disable-next-line max-params\n  constructor(service, readService, titleService, router, route) {\n    this.service = service;\n    this.readService = readService;\n    this.titleService = titleService;\n    this.router = router;\n    this.route = route;\n    _UpdateKundeComponent_instances.add(this);\n    this.updateForm = new FormGroup({});\n    log.debug('UpdateKundeComponent.constructor()');\n  }\n  ngOnInit() {\n    // Pfad-Parameter aus /buecher/:id/update\n    const id = this.route.snapshot.paramMap.get('id') ?? undefined;\n    this.readService.findById(id).pipe(first(), tap(result => {\n      __classPrivateFieldGet(this, _UpdateKundeComponent_instances, \"m\", _UpdateKundeComponent_setProps).call(this, result);\n      log.debug('UpdateKundeComponent.ngOnInit: kunde=akunde', this.kunde?.nachname);\n    })).subscribe();\n  }\n  /**\r\n   * Die aktuellen Stammdaten f&uuml;r das angezeigte Buch-Objekt\r\n   * zur&uuml;ckschreiben.\r\n   * @return false, um das durch den Button-Klick ausgel&ouml;ste Ereignis\r\n   *         zu konsumieren.\r\n   */\n  onSubmit() {\n    if (this.updateForm.pristine || this.kunde === undefined) {\n      log.debug('UpdateKundeComponent.onSubmit: keine Aenderungen');\n      return;\n    }\n    const {\n      familienstand\n    } = this.updateForm.value;\n    const {\n      nachname\n    } = this.updateForm.value;\n    const {\n      geschlecht\n    } = this.updateForm.value;\n    const {\n      sport\n    } = this.updateForm.value;\n    const {\n      reisen\n    } = this.updateForm.value;\n    const {\n      lesen\n    } = this.updateForm.value;\n    const {\n      kunde,\n      service\n    } = this;\n    const myInteresse = [];\n    if (sport) {\n      myInteresse.push('S');\n    }\n    if (lesen) {\n      myInteresse.push('L');\n    }\n    if (reisen) {\n      myInteresse.push('R');\n    }\n    log.debug('UpdateKundeComponent.onSubmit: Interessen setzen= ', myInteresse);\n    kunde.interessen = myInteresse;\n    log.debug('UpdateKundeComponent.onSubmit: Interessen setzen= ', myInteresse);\n    // datum, preis und rabatt koennen im Formular nicht geaendert werden\n    // was kann ich nicht ändern:\n    // geschlecht evtl,\n    // kunde.familienstand = familienstand;\n    kunde.nachname = nachname;\n    kunde.geschlecht = geschlecht;\n    kunde.familienstand = familienstand;\n    log.debug('UpdateKundeComponent.onSubmit: kunde=', kunde);\n    service.update(kunde).pipe(first(), tap(result => __classPrivateFieldGet(this, _UpdateKundeComponent_instances, \"m\", _UpdateKundeComponent_handleUpdateResult).call(this, result))).subscribe({\n      next: () => __classPrivateFieldGet(this, _UpdateKundeComponent_instances, \"m\", _UpdateKundeComponent_navigateHome).call(this)\n    });\n    // damit das (Submit-) Ereignis konsumiert wird und nicht an\n    // uebergeordnete Eltern-Komponenten propagiert wird bis zum\n    // Refresh der gesamten Seite\n    return false;\n  }\n}\n_UpdateKundeComponent_instances = new WeakSet(), _UpdateKundeComponent_setProps = function _UpdateKundeComponent_setProps(result) {\n  if (result instanceof FindError) {\n    __classPrivateFieldGet(this, _UpdateKundeComponent_instances, \"m\", _UpdateKundeComponent_handleFindError).call(this, result);\n    return;\n  }\n  this.kunde = result;\n  this.errorMsg = undefined;\n  const titel = `Aktualisieren ${this.kunde.id}`;\n  this.titleService.setTitle(titel);\n}, _UpdateKundeComponent_handleFindError = function _UpdateKundeComponent_handleFindError(err) {\n  const {\n    statuscode\n  } = err;\n  log.debug('UpdateKundeComponent.#handleError: statuscode=', statuscode);\n  this.kunde = undefined;\n  switch (statuscode) {\n    case 404 /* HttpStatusCode.NotFound */:\n      this.errorMsg = 'Kein Kunde gefunden.';\n      break;\n    case 429 /* HttpStatusCode.TooManyRequests */:\n      this.errorMsg = 'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n      break;\n    case 504 /* HttpStatusCode.GatewayTimeout */:\n      this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n      log.error('Laeuft der Appserver? Port-Forwarding?');\n      break;\n    default:\n      this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n      break;\n  }\n}, _UpdateKundeComponent_handleUpdateResult = function _UpdateKundeComponent_handleUpdateResult(result) {\n  if (!(result instanceof UpdateError)) {\n    return;\n  }\n  const {\n    statuscode\n  } = result;\n  log.debug('UpdateStammdatenComponent.#handleError: statuscode=', statuscode);\n  switch (statuscode) {\n    case 422 /* HttpStatusCode.UnprocessableEntity */:\n      {\n        const {\n          cause\n        } = result;\n        // TODO Aufbereitung der Fehlermeldung: u.a. Anfuehrungszeichen\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n        this.errorMsg = cause instanceof HttpErrorResponse ? cause.error : JSON.stringify(cause);\n        break;\n      }\n    case 429 /* HttpStatusCode.TooManyRequests */:\n      this.errorMsg = 'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n      break;\n    case 504 /* HttpStatusCode.GatewayTimeout */:\n      this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n      log.error('Laeuft der Appserver? Port-Forwarding?');\n      break;\n    default:\n      this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n      break;\n  }\n  log.debug('UpdateStammdatenComponent.#handleError: errorMsg=', this.errorMsg);\n}, _UpdateKundeComponent_navigateHome = /*#__PURE__*/function () {\n  var _UpdateKundeComponent_navigateHome2 = _asyncToGenerator(function* () {\n    yield this.router.navigate(['/']);\n  });\n  function _UpdateKundeComponent_navigateHome() {\n    return _UpdateKundeComponent_navigateHome2.apply(this, arguments);\n  }\n  return _UpdateKundeComponent_navigateHome;\n}();\nUpdateKundeComponent.ɵfac = function UpdateKundeComponent_Factory(t) {\n  return new (t || UpdateKundeComponent)(i0.ɵɵdirectiveInject(i1.KundeWriteService), i0.ɵɵdirectiveInject(i1.KundeReadService), i0.ɵɵdirectiveInject(i2.Title), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n};\nUpdateKundeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: UpdateKundeComponent,\n  selectors: [[\"hs-update-kunde\"]],\n  decls: 8,\n  vars: 4,\n  consts: [[1, \"updateRoot\"], [\"role\", \"form\", 3, \"formGroup\", \"submit\"], [3, \"updateForm\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"type\", \"submit\", 1, \"updateButton\"]],\n  template: function UpdateKundeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"form\", 1);\n      i0.ɵɵlistener(\"submit\", function UpdateKundeComponent_Template_form_submit_1_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵelement(2, \"hs-update-nachname\", 2)(3, \"hs-update-geschlecht\", 2)(4, \"hs-update-familienstand\", 2);\n      i0.ɵɵelementStart(5, \"div\")(6, \"button\", 3);\n      i0.ɵɵtext(7, \"Update\");\n      i0.ɵɵelementEnd()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formGroup\", ctx.updateForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"updateForm\", ctx.updateForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"updateForm\", ctx.updateForm);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"updateForm\", ctx.updateForm);\n    }\n  },\n  styles: [\"button[_ngcontent-%COMP%]:hover {\\n  opacity: 0.5;\\n}\\n\\n.updateRoot[_ngcontent-%COMP%] {\\n  margin-top: 20px;\\n  display: flex;\\n  align-items: center;\\n  flex-direction: column;\\n  justify-content: center;\\n  width: 100%;\\n}\\n\\n.updateInputField[_ngcontent-%COMP%] {\\n  width: 100%;\\n  margin: 5px;\\n}\\n\\n.updateButton[_ngcontent-%COMP%] {\\n  margin: auto;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAva3VuZGUvdXBkYXRlLWt1bmRlL3VwZGF0ZS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFlBQUE7QUFDRjs7QUFFQTtFQUNFLGdCQUFBO0VBQ0EsYUFBQTtFQUNBLG1CQUFBO0VBQ0Esc0JBQUE7RUFDQSx1QkFBQTtFQUNBLFdBQUE7QUFDRjs7QUFFQTtFQUNFLFdBQUE7RUFDQSxXQUFBO0FBQ0Y7O0FBRUE7RUFDQyxZQUFBO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJidXR0b246aG92ZXIge1xuICBvcGFjaXR5OiAwLjU7XG59XG5cbi51cGRhdGVSb290IHtcbiAgbWFyZ2luLXRvcDogMjBweDtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4udXBkYXRlSW5wdXRGaWVsZCB7XG4gIHdpZHRoOiAxMDAlO1xuICBtYXJnaW46IDVweDtcbn1cblxuLnVwZGF0ZUJ1dHRvbiB7XG4gbWFyZ2luOiBhdXRvO1xufVxuXG5cblxuXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":";;;AAsBA;AACA,SAEIA,SAAS,EAKTC,WAAW,QACR,WAAW;AAIlB;AACA,SAASC,iBAAiB,QAAwB,sBAAsB;AACxE,SAASC,KAAK,EAAEC,GAAG,QAAQ,gBAAgB;AAC3C,SAASC,SAAS,QAAQ,gBAAgB;AAE1C,OAAOC,GAAG,MAAM,UAAU;;;;;AAE1B;;;AAQA,OAAM,MAAOC,oBAAoB;EA0B7B;EACAC,YACqBC,OAA0B,EAC1BC,WAA6B,EAC7BC,YAAmB,EACnBC,MAAc,EACdC,KAAqB;IAJrB,YAAO,GAAPJ,OAAO;IACP,gBAAW,GAAXC,WAAW;IACX,iBAAY,GAAZC,YAAY;IACZ,WAAM,GAANC,MAAM;IACN,UAAK,GAALC,KAAK;;IA7BjB,eAAU,GAAG,IAAIR,SAAS,CAAC,EAAE,CAAC;IA+BnCC,GAAG,CAACQ,KAAK,CAAC,oCAAoC,CAAC;EACnD;EA5BAC,QAAQ;IACJ;IACA,MAAMC,EAAE,GAAG,IAAI,CAACH,KAAK,CAACI,QAAQ,CAACC,QAAQ,CAACC,GAAG,CAAC,IAAI,CAAC,IAAIC,SAAS;IAE9D,IAAI,CAACV,WAAW,CACXW,QAAQ,CAACL,EAAE,CAAC,CACZM,IAAI,CACDnB,KAAK,EAAE,EACPC,GAAG,CAACmB,MAAM,IAAG;MACTC,2BAAI,uEAAU,MAAd,IAAI,EAAWD,MAAM,CAAC;MACtBjB,GAAG,CAACQ,KAAK,CACL,6CAA6C,EAC7C,IAAI,CAACW,KAAK,EAAEC,QAAQ,CACvB;IACL,CAAC,CAAC,CACL,CACAC,SAAS,EAAE;EACpB;EAaA;;;;;;EAMAC,QAAQ;IACJ,IAAI,IAAI,CAACC,UAAU,CAACC,QAAQ,IAAI,IAAI,CAACL,KAAK,KAAKL,SAAS,EAAE;MACtDd,GAAG,CAACQ,KAAK,CAAC,kDAAkD,CAAC;MAC7D;;IAEJ,MAAM;MAAEiB;IAAa,CAAE,GAAG,IAAI,CAACF,UAAU,CAACG,KAEzC;IACD,MAAM;MAAEN;IAAQ,CAAE,GAAG,IAAI,CAACG,UAAU,CAACG,KAA6B;IAClE,MAAM;MAAEC;IAAU,CAAE,GAAG,IAAI,CAACJ,UAAU,CAACG,KAEtC;IACD,MAAM;MAAEE;IAAK,CAAE,GAAG,IAAI,CAACL,UAAU,CAACG,KAEjC;IACD,MAAM;MAAEG;IAAM,CAAE,GAAG,IAAI,CAACN,UAAU,CAACG,KAElC;IACD,MAAM;MAAEI;IAAK,CAAE,GAAG,IAAI,CAACP,UAAU,CAACG,KAEjC;IACD,MAAM;MAAEP,KAAK;MAAEhB;IAAO,CAAE,GAAG,IAAI;IAC/B,MAAM4B,WAAW,GAAG,EAAE;IACtB,IAAIH,KAAK,EAAE;MACPG,WAAW,CAACC,IAAI,CAAC,GAAG,CAAC;;IAEzB,IAAIF,KAAK,EAAE;MACPC,WAAW,CAACC,IAAI,CAAC,GAAG,CAAC;;IAEzB,IAAIH,MAAM,EAAE;MACRE,WAAW,CAACC,IAAI,CAAC,GAAG,CAAC;;IAEzBhC,GAAG,CAACQ,KAAK,CACL,oDAAoD,EACpDuB,WAAW,CACd;IACDZ,KAAK,CAACc,UAAU,GAAGF,WAAW;IAC9B/B,GAAG,CAACQ,KAAK,CACL,oDAAoD,EACpDuB,WAAW,CACd;IACD;IACA;IACA;IACA;IACAZ,KAAK,CAACC,QAAQ,GAAGA,QAAQ;IACzBD,KAAK,CAACQ,UAAU,GAAGA,UAAU;IAC7BR,KAAK,CAACM,aAAa,GAAGA,aAAa;IACnCzB,GAAG,CAACQ,KAAK,CAAC,uCAAuC,EAAEW,KAAK,CAAC;IACzDhB,OAAO,CACF+B,MAAM,CAACf,KAAK,CAAC,CACbH,IAAI,CACDnB,KAAK,EAAE,EACPC,GAAG,CAACmB,MAAM,IAAIC,2BAAI,iFAAoB,MAAxB,IAAI,EAAqBD,MAAM,CAAC,CAAC,CAClD,CACAI,SAAS,CAAC;MAAEc,IAAI,EAAE,MAAMjB,2BAAI,2EAAc,MAAlB,IAAI;IAAgB,CAAE,CAAC;IACpD;IACA;IACA;IACA,OAAO,KAAK;EAChB;;0HAEUD,MAAyB;EAC/B,IAAIA,MAAM,YAAYvB,SAAS,EAAE;IAC7BwB,2BAAI,8EAAiB,MAArB,IAAI,EAAkBD,MAAM,CAAC;IAC7B;;EAGJ,IAAI,CAACE,KAAK,GAAGF,MAAM;EACnB,IAAI,CAACmB,QAAQ,GAAGtB,SAAS;EAEzB,MAAMuB,KAAK,GAAG,iBAAiB,IAAI,CAAClB,KAAK,CAACT,EAAE,EAAE;EAC9C,IAAI,CAACL,YAAY,CAACiC,QAAQ,CAACD,KAAK,CAAC;AACrC,CAAC,yFAEgBE,GAAc;EAC3B,MAAM;IAAEC;EAAU,CAAE,GAAGD,GAAG;EAC1BvC,GAAG,CAACQ,KAAK,CAAC,gDAAgD,EAAEgC,UAAU,CAAC;EAEvE,IAAI,CAACrB,KAAK,GAAGL,SAAS;EAEtB,QAAQ0B,UAAU;IACd;MACI,IAAI,CAACJ,QAAQ,GAAG,sBAAsB;MACtC;IACJ;MACI,IAAI,CAACA,QAAQ,GACT,+DAA+D;MACnE;IACJ;MACI,IAAI,CAACA,QAAQ,GAAG,sCAAsC;MACtDpC,GAAG,CAACyC,KAAK,CAAC,wCAAwC,CAAC;MACnD;IACJ;MACI,IAAI,CAACL,QAAQ,GAAG,yCAAyC;MACzD;EAAM;AAElB,CAAC,+FAEmBnB,MAA2B;EAC3C,IAAI,EAAEA,MAAM,YAAYtB,WAAW,CAAC,EAAE;IAClC;;EAGJ,MAAM;IAAE6C;EAAU,CAAE,GAAGvB,MAAM;EAC7BjB,GAAG,CAACQ,KAAK,CACL,qDAAqD,EACrDgC,UAAU,CACb;EAED,QAAQA,UAAU;IACd;MAAyC;QACrC,MAAM;UAAEE;QAAK,CAAE,GAAGzB,MAAM;QACxB;QACA;QACA,IAAI,CAACmB,QAAQ,GACTM,KAAK,YAAY9C,iBAAiB,GAC5B8C,KAAK,CAACD,KAAK,GACXE,IAAI,CAACC,SAAS,CAACF,KAAK,CAAC;QAC/B;;IAEJ;MACI,IAAI,CAACN,QAAQ,GACT,+DAA+D;MACnE;IACJ;MACI,IAAI,CAACA,QAAQ,GAAG,sCAAsC;MACtDpC,GAAG,CAACyC,KAAK,CAAC,wCAAwC,CAAC;MACnD;IACJ;MACI,IAAI,CAACL,QAAQ,GAAG,yCAAyC;MACzD;EAAM;EAGdpC,GAAG,CAACQ,KAAK,CACL,mDAAmD,EACnD,IAAI,CAAC4B,QAAQ,CAChB;AACL,CAAC;EAAA,4DAED,aAAK;IACD,MAAM,IAAI,CAAC9B,MAAM,CAACuC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;EACrC,CAAC;EAAA,SAFIC;IAAA;EAAA;EAAA;AAAA,GAEJ;;mBAzLQ7C,oBAAoB;AAAA;;QAApBA,oBAAoB;EAAA8C;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MClDjCC,8BAAwB;MACqBA;QAAA,OAAUC,cAAU;MAAA,EAAC;MAC9DD,wCAAmE;MAGnEA,2BAAK;MAC0EA,sBAAM;MAAAA,iBAAS;;;MAL1FA,eAAwB;MAAxBA,0CAAwB;MACRA,eAAyB;MAAzBA,2CAAyB;MACvBA,eAAyB;MAAzBA,2CAAyB;MACtBA,eAAyB;MAAzBA,2CAAyB","names":["FindError","UpdateError","HttpErrorResponse","first","tap","FormGroup","log","UpdateKundeComponent","constructor","service","readService","titleService","router","route","debug","ngOnInit","id","snapshot","paramMap","get","undefined","findById","pipe","result","__classPrivateFieldGet","kunde","nachname","subscribe","onSubmit","updateForm","pristine","familienstand","value","geschlecht","sport","reisen","lesen","myInteresse","push","interessen","update","next","errorMsg","titel","setTitle","err","statuscode","error","cause","JSON","stringify","navigate","_UpdateKundeComponent_navigateHome","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["C:\\Users\\Dominik\\software-engineering\\kundeweb\\src\\app\\kunde\\update-kunde\\update-kunde.component.ts","C:\\Users\\Dominik\\software-engineering\\kundeweb\\src\\app\\kunde\\update-kunde\\update-kunde.component.html"],"sourcesContent":["// eslint-disable-next-line eslint-comments/disable-enable-pair\n/* eslint-disable max-statements */\n// eslint-disable-next-line eslint-comments/disable-enable-pair\n/* eslint-disable max-lines-per-function */\n/*\n * Copyright (C) 2015 - present Juergen Zimmermann, Hochschule Karlsruhe\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { ActivatedRoute, Router } from '@angular/router'; // eslint-disable-line @typescript-eslint/consistent-type-imports\n/* eslint-disable @typescript-eslint/consistent-type-imports */\nimport {\n    type Familienstand,\n    FindError,\n    type GeschlechtType,\n    type Kunde,\n    KundeReadService,\n    KundeWriteService,\n    UpdateError,\n} from '../shared';\n/* eslint-enable @typescript-eslint/consistent-type-imports */\n// eslint-disable-next-line sort-imports\nimport { Component, type OnInit } from '@angular/core';\n// eslint-disable-next-line import/no-unresolved\nimport { HttpErrorResponse, HttpStatusCode } from '@angular/common/http';\nimport { first, tap } from 'rxjs/operators';\nimport { FormGroup } from '@angular/forms';\nimport { Title } from '@angular/platform-browser'; // eslint-disable-line @typescript-eslint/consistent-type-imports\nimport log from 'loglevel';\n\n/**\n * Komponente f&uuml;r das Tag <code>hs-update-buch</code>\n */\n@Component({\n    selector: 'hs-update-kunde',\n    templateUrl: './update-kunde.component.html',\n    styleUrls: ['./update.component.scss'],\n})\nexport class UpdateKundeComponent implements OnInit {\n    kunde: Kunde | undefined;\n\n    readonly updateForm = new FormGroup({});\n\n    errorMsg: string | undefined;\n\n    ngOnInit() {\n        // Pfad-Parameter aus /buecher/:id/update\n        const id = this.route.snapshot.paramMap.get('id') ?? undefined;\n\n        this.readService\n            .findById(id)\n            .pipe(\n                first(),\n                tap(result => {\n                    this.#setProps(result);\n                    log.debug(\n                        'UpdateKundeComponent.ngOnInit: kunde=akunde',\n                        this.kunde?.nachname,\n                    );\n                }),\n            )\n            .subscribe();\n    }\n\n    // eslint-disable-next-line max-params\n    constructor(\n        private readonly service: KundeWriteService,\n        private readonly readService: KundeReadService,\n        private readonly titleService: Title,\n        private readonly router: Router,\n        private readonly route: ActivatedRoute,\n    ) {\n        log.debug('UpdateKundeComponent.constructor()');\n    }\n\n    /**\n     * Die aktuellen Stammdaten f&uuml;r das angezeigte Buch-Objekt\n     * zur&uuml;ckschreiben.\n     * @return false, um das durch den Button-Klick ausgel&ouml;ste Ereignis\n     *         zu konsumieren.\n     */\n    onSubmit() {\n        if (this.updateForm.pristine || this.kunde === undefined) {\n            log.debug('UpdateKundeComponent.onSubmit: keine Aenderungen');\n            return;\n        }\n        const { familienstand } = this.updateForm.value as {\n            familienstand: Familienstand;\n        };\n        const { nachname } = this.updateForm.value as { nachname: string };\n        const { geschlecht } = this.updateForm.value as {\n            geschlecht: GeschlechtType;\n        };\n        const { sport } = this.updateForm.value as {\n            sport: boolean;\n        };\n        const { reisen } = this.updateForm.value as {\n            reisen: boolean;\n        };\n        const { lesen } = this.updateForm.value as {\n            lesen: boolean;\n        };\n        const { kunde, service } = this;\n        const myInteresse = [];\n        if (sport) {\n            myInteresse.push('S');\n        }\n        if (lesen) {\n            myInteresse.push('L');\n        }\n        if (reisen) {\n            myInteresse.push('R');\n        }\n        log.debug(\n            'UpdateKundeComponent.onSubmit: Interessen setzen= ',\n            myInteresse,\n        );\n        kunde.interessen = myInteresse;\n        log.debug(\n            'UpdateKundeComponent.onSubmit: Interessen setzen= ',\n            myInteresse,\n        );\n        // datum, preis und rabatt koennen im Formular nicht geaendert werden\n        // was kann ich nicht ändern:\n        // geschlecht evtl,\n        // kunde.familienstand = familienstand;\n        kunde.nachname = nachname;\n        kunde.geschlecht = geschlecht;\n        kunde.familienstand = familienstand;\n        log.debug('UpdateKundeComponent.onSubmit: kunde=', kunde);\n        service\n            .update(kunde)\n            .pipe(\n                first(),\n                tap(result => this.#handleUpdateResult(result)),\n            )\n            .subscribe({ next: () => this.#navigateHome() });\n        // damit das (Submit-) Ereignis konsumiert wird und nicht an\n        // uebergeordnete Eltern-Komponenten propagiert wird bis zum\n        // Refresh der gesamten Seite\n        return false;\n    }\n\n    #setProps(result: FindError | Kunde) {\n        if (result instanceof FindError) {\n            this.#handleFindError(result);\n            return;\n        }\n\n        this.kunde = result;\n        this.errorMsg = undefined;\n\n        const titel = `Aktualisieren ${this.kunde.id}`;\n        this.titleService.setTitle(titel);\n    }\n\n    #handleFindError(err: FindError) {\n        const { statuscode } = err;\n        log.debug('UpdateKundeComponent.#handleError: statuscode=', statuscode);\n\n        this.kunde = undefined;\n\n        switch (statuscode) {\n            case HttpStatusCode.NotFound:\n                this.errorMsg = 'Kein Kunde gefunden.';\n                break;\n            case HttpStatusCode.TooManyRequests:\n                this.errorMsg =\n                    'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n                break;\n            case HttpStatusCode.GatewayTimeout:\n                this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n                log.error('Laeuft der Appserver? Port-Forwarding?');\n                break;\n            default:\n                this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n                break;\n        }\n    }\n\n    #handleUpdateResult(result: Kunde | UpdateError) {\n        if (!(result instanceof UpdateError)) {\n            return;\n        }\n\n        const { statuscode } = result;\n        log.debug(\n            'UpdateStammdatenComponent.#handleError: statuscode=',\n            statuscode,\n        );\n\n        switch (statuscode) {\n            case HttpStatusCode.UnprocessableEntity: {\n                const { cause } = result;\n                // TODO Aufbereitung der Fehlermeldung: u.a. Anfuehrungszeichen\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n                this.errorMsg =\n                    cause instanceof HttpErrorResponse\n                        ? cause.error\n                        : JSON.stringify(cause);\n                break;\n            }\n            case HttpStatusCode.TooManyRequests:\n                this.errorMsg =\n                    'Zu viele Anfragen. Bitte versuchen Sie es später noch einmal.';\n                break;\n            case HttpStatusCode.GatewayTimeout:\n                this.errorMsg = 'Ein interner Fehler ist aufgetreten.';\n                log.error('Laeuft der Appserver? Port-Forwarding?');\n                break;\n            default:\n                this.errorMsg = 'Ein unbekannter Fehler ist aufgetreten.';\n                break;\n        }\n\n        log.debug(\n            'UpdateStammdatenComponent.#handleError: errorMsg=',\n            this.errorMsg,\n        );\n    }\n\n    async #navigateHome() {\n        await this.router.navigate(['/']);\n    }\n}\n","<div class=\"updateRoot\">\n  <form [formGroup]=\"updateForm\" role=\"form\" (submit)=\"onSubmit()\">\n    <hs-update-nachname [updateForm]=\"updateForm\"></hs-update-nachname>\n    <hs-update-geschlecht [updateForm]=\"updateForm\"> </hs-update-geschlecht>\n    <hs-update-familienstand [updateForm]=\"updateForm\"></hs-update-familienstand>\n    <div>\n      <button class=\"updateButton\" mat-raised-button color=\"primary\" type=\"submit\">Update</button>\n    </div>\n  </form>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}